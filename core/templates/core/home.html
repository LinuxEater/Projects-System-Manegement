{% extends 'core/base.html' %}

{% block title %}Home - Freelance Manager{% endblock %}

{% block content %}
<div class="container mx-auto px-4 py-8">
    <div class="flex justify-between items-center mb-6">
        <h1 class="text-4xl font-bold text-gray-800">My Projects</h1>
        <a href="{% url 'project_create' %}" class="btn btn-primary"><i class="fas fa-plus"></i> Add Project</a>
    </div>

    <!-- Search and Filter Section -->
    <div class="mb-6 bg-white p-4 rounded-lg shadow-md">
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <!-- Search Form -->
            <form method="get" action="{% url 'home' %}" class="flex items-center">
                <input type="text" name="search_query" class="w-full px-4 py-2 border border-gray-300 rounded-l-md focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="Search by project or client..." value="{{ search_query|default:'' }}">
                <button type="submit" class="bg-blue-500 text-white px-4 py-2 rounded-r-md hover:bg-blue-600"><i class="fas fa-search"></i></button>
            </form>
            <!-- Filter Buttons -->
            <div class="flex items-center justify-center md:justify-end space-x-2">
                <a href="{% url 'home' %}?filter=week" class="btn btn-sm {% if request.GET.filter == 'week' %}btn-primary{% else %}btn-outline-secondary{% endif %}">This Week</a>
                <a href="{% url 'home' %}?filter=month" class="btn btn-sm {% if request.GET.filter == 'month' %}btn-primary{% else %}btn-outline-secondary{% endif %}">This Month</a>
                <a href="{% url 'home' %}" class="btn btn-sm {% if not request.GET.filter %}btn-primary{% else %}btn-outline-secondary{% endif %}">All</a>
            </div>
        </div>
    </div>

    <div id="project-list" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
        {% for project in projects %}
        <div class="bg-white rounded-lg shadow-lg overflow-hidden transform hover:-translate-y-2 transition-transform duration-300">
            {% if project.image %}
            <img src="{{ project.image.url }}" class="w-full h-48 object-cover" alt="{{ project.title }}">
            {% else %}
            <div class="w-full h-48 bg-gray-200 flex items-center justify-center">
                <i class="fas fa-image text-gray-400 text-4xl"></i>
            </div>
            {% endif %}
            <div class="p-6">
                <h5 class="text-xl font-bold mb-2">{{ project.title }}</h5>
                <p class="text-gray-600 mb-4">{{ project.client.name }}</p>
                <p class="text-gray-700 text-sm mb-4 line-clamp-3 overflow-hidden">{{ project.description|truncatewords:20 }}</p>
                <div class="flex justify-between items-center">
                    <div class="btn-group">
                        <a href="{% url 'project_detail' project.id %}" class="btn btn-sm btn-outline-secondary"><i class="fas fa-eye mr-1"></i>View</a>
                        <a href="{% url 'project_edit' project.id %}" class="btn btn-sm btn-outline-secondary"><i class="fas fa-edit mr-1"></i>Edit</a>
                    </div>
                    <div class="font-bold text-lg text-green-600">
                        R$ {{ project.value }}
                    </div>
                </div>
            </div>
            <div class="px-6 py-3 bg-gray-50 flex items-center justify-between">
                {% if project.status == 'P' %}
                <span class="badge bg-warning text-dark"><i class="fas fa-clock mr-1"></i> Pending</span>
                {% elif project.status == 'I' %}
                <span class="badge bg-info text-dark"><i class="fas fa-spinner fa-spin mr-1"></i> In Progress</span>
                {% elif project.status == 'C' %}
                <span class="badge bg-success"><i class="fas fa-check-circle mr-1"></i> Completed</span>
                {% endif %}
            </div>
        </div>
        {% empty %}
        <div class="col-span-full text-center py-12 bg-white rounded-lg shadow-md">
            <p class="text-gray-500 text-xl">No projects found.</p>
            {% if search_query %}
            <p class="text-gray-500">No projects match your search for "{{ search_query }}".</p>
            {% elif request.GET.filter %}
            <p class="text-gray-500">No projects found for the selected period.</p>
            {% else %}
            <a href="#" class="btn btn-primary mt-4"><i class="fas fa-plus"></i> Add Your First Project</a>
            {% endif %}
        </div>
        {% endfor %}
    </div>
</div>
{% endblock %}